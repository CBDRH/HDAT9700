<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="true" />

<title>HDAT9700: Multilevel Modelling (Part I)</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->


<link rel="stylesheet" href="css/tutorials.css" type="text/css" />

</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<p><img src="images/UNSW_2017_Big_Data_landscape.jpg" style="width:75.0%" /></p>
<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p>Welcome to HDAT9700 Statistical Modelling II - Multilevel Modelling part I!</p>
<p><img src="https://youtu.be/OzGgbrGn7ls" /></p>
<p>This chapter introduces multilevel modelling—a statistical approach to analyse grouped or clustered data. You will cover:</p>
<ul>
<li>Multilevel structures</li>
<li>Multilevel research questions</li>
<li>Multilevel notation</li>
<li>Variance components models<br />
</li>
<li>Random intercept models<br />
</li>
<li>Random slope models</li>
</ul>
<p>A case study focusing on birth weight is used throughout for illustration.</p>
<hr />
<div id="section-pre-reading" class="section level3">
<h3>Pre-reading</h3>
<p>The pre-reading for this chapter is <a href="https://thepsychologist.s3.eu-west-2.amazonaws.com/articles/pdfs/0912cart.pdf?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIA3JJOMCSRX35UA6UU%2F20200908%2Feu-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20200908T031225Z&amp;X-Amz-SignedHeaders=Host&amp;X-Amz-Expires=10&amp;X-Amz-Signature=137981da00a71118898f3b27b62d4bcdab85113de23be9861887ccc03847d9af">Murder, muddled thinking and multilevel modelling by Martin Cartwright, Gemma Traviss and Andrew Blance, The Psychologist (2012) Vol 25 No 9</a></p>
</div>
<div id="section-core-reading" class="section level3">
<h3>Core reading:</h3>
<p>The reference text for this chapter is <a href="https://journals.sagepub.com/doi/abs/10.5127/jep.013711">A Primer on Using Multilevel Models in Clinical and Experimental Psychopathology Research by Andy Field and Daniel Wright, Journal of Experimental Psychopathology 2(2) 2011</a>.</p>
</div>
<div id="section-additional-reading" class="section level3">
<h3>Additional reading:</h3>
<p>Blance (2012) Chapter 5 Multilevel Modelling <em>in</em> Modern Methods for Epidemiology by Yu-Kang and Greenwood (eds) The text is available online <a href="https://link.springer.com/chapter/10.1007/978-94-007-3024-3_5">here</a>.</p>
</div>
</div>
<div id="section-multilevel-contexts" class="section level2">
<h2>Multilevel contexts</h2>
<p><img src="https://youtu.be/eBItxNkZCLs" /></p>
<p>Health systems often have a complex structure, with factors at different levels influencing health outcomes. For example, the success of a surgery may depend on the patients’ own health status but may also be influenced by characteristics of their surgeon, the hospital they are attending or the environment or country that they are living in.</p>
<p>Many real-world datasets will exhibit this complex structure. This can be because the natural complexity of the system has been successfully captured in the data, for example when an administrative dataset records information on patients who attend many different hospitals, as well as information on the hospitals. Complexity can also be the captured by the methodology used to collect the data, such as sample surveys with two or more sample stages at different levels. Rather than sample 1,000 patients at random from the population, one could sample 20 GPs from a GP registry, and then sample 50 patients for each GP. The resulting dataset comprises patients who are nested or clustered within GPs. (This methodological approach has a practical advantage: if recruiting patients through GPs it is administratively simpler to handle a smaller number of GP clinics than a different GP clinic for each individual in the study. This approach also has an analytical advantage. Recording data for multiple lower level units within each higher level unit makes it possible to study the different levels of a complex system, for such as how characteristics at the level of the GP clinic may affect outcomes at the level of the patient.)</p>
<p>Data exhibiting complex structure with factors operating at different levels are referred to as <strong>multilevel</strong> data. In general we consider three broad multilevel structures:</p>
<ol style="list-style-type: decimal">
<li>Hierarchical</li>
<li>Multiple membership</li>
<li>Cross-classified</li>
</ol>
<div id="section-hierarchical-data-structures" class="section level3">
<h3>Hierarchical data structures</h3>
<p>Hierarchical data structures arise when lower level units are nested or clustered within higher level units. Examples of a two-level hierarchical data structure include:</p>
<ol style="list-style-type: decimal">
<li>Patients nested within hospitals</li>
<li>Observations nested within patients.</li>
</ol>
<hr />
<div id="section-a-two-level-hierarchy-patients-level-1-nested-within-hospitals-level-2" class="section level4">
<h4>A two level hierarchy: patients (level 1) nested within hospitals (level 2)</h4>
<p><img src="images/context1.png" style="width:75.0%" /></p>
<hr />
</div>
<div id="section-a-two-level-hierarchy-repeated-observations-level-1-nested-within-patients-level-2" class="section level4">
<h4>A two level hierarchy: repeated observations (level 1) nested within patients (level 2)</h4>
<p><img src="images/context2.png" style="width:75.0%" /></p>
<hr />
<p>Note that, in the first example, patient is the lower level unit whereas in the second example patient is the higher level or grouping unit. The choice of higher or lower levels depends on the nature of the data and the research question at hand.</p>
<p>Hierarchical data structures needn’t be limited to two levels. We could have three level hierarchies, such as patients nested within hospitals which are in turn nested within within regions. An example of a four level hierarchy would be repeat observations from patients, who are clustered within hospitals which are in turn nested within regions.</p>
<hr />
</div>
<div id="section-a-three-level-hierarchy-patients-level-1-nested-within-hospitals-level-2-nested-within-areas-level-3" class="section level4">
<h4>A three level hierarchy: patients (level 1) nested within hospitals (level 2) nested within areas (level 3)</h4>
<p><img src="images/context3.png" style="width:75.0%" /></p>
<hr />
</div>
</div>
<div id="section-multiple-membership-data-structures" class="section level3">
<h3>Multiple membership data structures</h3>
<p>The previous examples deal with strict hierarchies: lower level units belong to one higher level unit only. Real life data and applications can be more complicated of course. Multiple membership data arise when lower level units are members of multiple higher level units. Examples of multiple membership data structures include:</p>
<ol style="list-style-type: decimal">
<li>Patients attending multiple hospitals</li>
<li>Consultants employed by multiple health districts</li>
</ol>
<hr />
<div id="section-multiple-membership-patients-level-1-attend-multiple-hospitals-level-2" class="section level4">
<h4>Multiple membership: patients (level 1) attend multiple hospitals (level 2)</h4>
<p><img src="images/context4.png" style="width:75.0%" /></p>
</div>
</div>
<div id="section-cross-classified-data-structures" class="section level3">
<h3>Cross-classified data structures</h3>
<p>Cross-classified data structures arise when lower level units lie within a cross-classification of multiple higher level units. An example of this is the cross-classification of patients within hospitals and areas. People from the same area will attend different hospitals and people attending the same hospital will come from different areas.</p>
<hr />
<div id="section-cross-classification-patients-level-1-lie-within-a-cross-classification-of-areas-and-hospitals." class="section level4">
<h4>Cross-classification: Patients (level 1) lie within a cross-classification of areas and hospitals.</h4>
<p><img src="images/context5.png" style="width:75.0%" /></p>
<hr />
</div>
</div>
</div>
<div id="section-challenges" class="section level2">
<h2>Challenges</h2>
<p>Analysing data with a multilevel structure presents a challenge because lower level units clustered within the same higher-level unit are likely to have share some common characteristics.</p>
<ul>
<li>Patients attending a public hospital may be more similar than patients attending a private hospital<br />
</li>
<li>Repeat observations taken from the same individual may be more similar compared to an observation from a different individual<br />
</li>
<li>Surgeries performed by the same surgeon may have more similar results compared to a different surgeon<br />
</li>
<li>Children from the same family have a more similar risk of cystic fybrosis compared to children from different families</li>
</ul>
<div id="section-a-challenge" class="section level3">
<h3>A challenge?</h3>
<p>This similarity between observations from the same higher level unit is refered to as <strong>dependency</strong>. Dependency violates a key assumption of (generalised) linear models: observations should be independent. By ignoring dependency, we falsely inflate the number of independent observations available in the data and as a consequence, model-based estimates will be overly confident (i.e. standard errors are too small and confidence intervals are too narrow).</p>
<p>Various options are available to address dependency between higher level units:</p>
<p><strong>1. Ignore it</strong><br />
This can be a valid option if the dependency is very low (but generally it is not a good idea). More later on what counts as a “low” dependency</p>
<p><strong>2. Adjust standard errors</strong><br />
Standard error calculations can be adjusted to account for the clustering of similar lower-level units within higher level units.</p>
<p><strong>3. Add fixed effects for each category of the higher level</strong><br />
It is possible to control for a higher level variable by including a dummy for each category of the higher level in a statistical model. This is referred to as a <strong>fixed effects</strong> model. This can be reasonable if there is a small number of higher level units which are distinct from each other. For example, if our data comprised patients clustered within the eight local health districts (LHDs) in New South Wales, we could control for dependency between by the LHDs including a dummy variable for each district in the model.</p>
<p>This approach has a few downsides:</p>
<ul>
<li>It is not possible to control for characteristics of the higher level variable(s) (e.g. LHD level statistics).</li>
<li>There is an additional model parameter for each category of the higher level, so this becomes an issue if there are a large number of categories, especially if some categories are sparse.</li>
</ul>
<p><strong>4. Control for higher level variables</strong> It is possible to control for higher-level variables in a single-level model. However, this approach focuses on variation within higher level units; variation between higher level units is still ignored.</p>
</div>
<div id="section-an-opportunity" class="section level3">
<h3>An opportunity?</h3>
<p>The approaches outlined above treat the clustering inherent to many datasets as <em>a nuisance</em> to be dealt with. However, often we are explicitly interested in understanding the roles of factors at different levels, and the relationships between them. From this perspective, multilevel data offers <em>an opportunity</em> to understand complex structures and answer research questions about factors operating at different levels. <strong>Multilevel modelling</strong> is a methodological approach for modelling hierarchical data structures. This approach overcomes the drawbacks of the approaches which treat clustering as a nuisance. With multilevel modelling, we can:</p>
<ul>
<li>Correct for the dependency caused by the clustering of similar lower level units within higher level units<br />
</li>
<li>Understand the relationship between higher level characteristics and lower-level outcomes<br />
</li>
<li>Explicitly model the variation between higher level groups and within higher level groups</li>
</ul>
<div class="aside">
<h3 id="section-a-model-by-any-other-name">A model by any other name…</h3>
<p>Multilevel models are also referred to as:</p>
<ul>
<li>Hierarchical linear models (especially in the USA)<br />
</li>
<li>Mixed effects models<br />
</li>
<li>Random effects models</li>
</ul>
</div>
</div>
</div>
<div id="section-opportunities" class="section level2">
<h2>Opportunities</h2>
<div id="section-multilevel-propositions" class="section level3">
<h3>Multilevel propositions</h3>
<p>Multilevel data with a two-level hierarchy allow us to pose three kinds of propositions:</p>
<ol style="list-style-type: decimal">
<li><p>Propositions about lower level factors<br />
For example, “elderly patients are more likely to pick up an infection in hospital”</p></li>
<li><p>Propostions about higher levels factors<br />
For example, Hospital-acquired infections are lower in hospitals with well-funded hygiene service departments</p></li>
<li><p>Propositions about interactions between higher level and lower level factors<br />
For example, Elderly patients are at a lower risk of infection in well-funded hospitals</p></li>
</ol>
</div>
<div id="section-multilevel-research-questions" class="section level3">
<h3>Multilevel research questions</h3>
<p>Multilevel modelling is a very popular method that is used to address thousands of applied reaserch questions annually, in health research and many other domains. Examples of some recent questions addressed using multilevel modelling include</p>
<ul>
<li><p>Is the risk of developing Alzheimer’s disease really higher in rural areas? <a href="https://doi.org/10.1016/j.healthplace.2018.09.003">(Astell-urt and Feng 2018)</a></p></li>
<li><p>What hospital- and patient-level factors predict agreement between self-report and administrative records of morbidity. <a href="http://dx.doi.org/10.1136/bmjopen-2014-005768">(Lujic et al 2014)</a></p></li>
<li><p>How does ethnicity and occupation influence residential segregation in Sydney <a href="https://doi.org/10.1177/0042098017730239">(Jones et al 2017)</a></p></li>
</ul>
</div>
</div>
<div id="section-visualising-mlms" class="section level2" data-progressive="TRUE">
<h2>Visualising MLMs</h2>
<p>Multilevel models can be viewed as an extension of general linear regression so, to start, consider two continuous variables, X and Y.</p>
<p><img src="images/mlm1.png" style="width:75.0%" /></p>
<div id="section-adding-a-line" class="section level3">
<h3>Adding a line</h3>
<p>We can fit a straight line to our data. The model has the familiar form</p>
<p><span class="math display">\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + e_{i}
\]</span> <img src="images/mlm2.png" style="width:75.0%" /></p>
</div>
<div id="section-multilevel-data" class="section level3">
<h3>Multilevel data</h3>
<p>But what if our individual data points are grouped according to some higher level unit, for example patients nested within hosptitals? In the scatterplot below, imagine that each point represents a patient and that the colours indicated different hospitals. So all patients represented by green points attended the same hospital, and so on.</p>
<p><img src="images/mlm3.png" style="width:75.0%" /></p>
</div>
<div id="section-separate-lines" class="section level3">
<h3>Separate lines</h3>
<p>In this case it might be tempting to fit a separate line for each higher level unit</p>
<p><img src="images/mlm4.png" style="width:75.0%" /></p>
<p>With some rearranging, the regression equation becomes <span class="math display">\[
y_{ij} = \beta_{0j} + \beta_{1}x_{ij} + e_{ij}
\]</span></p>
<p>Note that all of the model parameters now all have <strong>a <span class="math inline">\(j\)</span> subscript</strong> to indicate that individual <span class="math inline">\(i\)</span> belongs to hospital <span class="math inline">\(j\)</span>.</p>
<p>To allow for a seperate line for each hospital we can seperate out the intercept term into the group mean intercept <span class="math inline">\(\beta_{0}\)</span> and the departures from the group mean for each hospital, denoted <span class="math inline">\(u_{0j}\)</span>. <span class="math display">\[
\beta_{0j} = \beta_{0} + u_{0j}
\]</span> The regression equation becomes <span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1}x_{i} + u_{0j} + e_{ij}
\]</span> The values <span class="math inline">\(u_{0j}\)</span> represent the difference from the group mean intercept for each group, as depicted below:</p>
<p><img src="images/mlm5.png" style="width:75.0%" /></p>
</div>
</div>
<div id="section-practical-1" class="section level2">
<h2>Practical 1</h2>
<div id="section-introducing-the-sample-data" class="section level3">
<h3>Introducing the sample data</h3>
<p>The practical sessions in this chapter are based on data from <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jae.851">Abrevaya (2006)</a> <em>Estimating the effect of smoking on birth outcomes using a matched panel data approach</em>. The description of the variables in the dataset can be found <a href="http://qed.econ.queensu.ca/jae/2006-v21.4/abrevaya/readme.ja.txt">here</a>. This is a panel dataset, meaning that there are multiple birth records for each mother. The dataset can be obtained from the data archive of the Journal of Applied Econometrics. We only look at a random 10% of the original data in this exercise.</p>
<p>We will focus on the relationship between <em>maternal age</em> and <em>birthweight</em>.</p>
<div id="section-here-is-a-brief-description-of-the-available-variables" class="section level4">
<h4>Here is a brief description of the available variables:</h4>
<ul>
<li><strong>momid</strong> identification number of the mother<br />
</li>
<li><strong>idx</strong> index number of a mother’s birth<br />
</li>
<li><strong>mage</strong> age of mother (in years)<br />
</li>
<li><strong>gestat</strong> length of gestation (in weeks)<br />
</li>
<li><strong>birwt</strong> birthweight (in grams)</li>
<li><strong>smoke</strong> indicator variable for smoking status (1=smoker, 0=nonsmoker)</li>
<li><strong>married</strong> indicator variable for marital status (1=married, 0=unmarried)</li>
<li><strong>collgrad</strong> college-graduate indicator</li>
<li><strong>black</strong> indicator variable for black race (1=black, 0=white)</li>
<li><strong>birwtc</strong> Standardised values of <strong>birwt</strong></li>
<li><strong>magec</strong> Standardised values of <strong>mage</strong></li>
</ul>
<p>The data are pre-loaded in your environment in a dataframe named <strong>birwt.dat</strong></p>
</div>
<div id="section-use-the-space-below-to-explore-the-data-and-answer-the-questions" class="section level4">
<h4>Use the space below to explore the data and answer the questions:</h4>
<div class="tutorial-exercise" data-label="ex1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="20">
<pre class="text"><code># How many records and variables are present?
dim(birwt.dat)


# Examine the data---which variables are at level 1 (baby) and which are at level 2 (mother)?


# How many mothers are in the dataset?


# What is the average number of births per mother?</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
</div>
<div id="section-fit-a-linear-model-to-exlore-the-relationship-between-maternal-age-exposure-and-birthweight-outcome-ignoring-the-clustering-of-births-within-mothers-for-now." class="section level4">
<h4>Fit a linear model to exlore the relationship between maternal age (exposure) and birthweight (outcome), ignoring the clustering of births within mothers for now.</h4>
<div class="tutorial-exercise" data-label="ex2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="5">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ex2-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># Use the lm function</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex2-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># Use the lm function
mod.lm &lt;- lm(birwt ~ mage, data=birwt.dat)
summary(mod.lm)</code></pre>
</div>
</div>
<div id="section-plot-the-predicted-values-from-this-model" class="section level4">
<h4>Plot the predicted values from this model</h4>
<div class="tutorial-exercise" data-label="ex2b" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="10">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ex2b-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>mod.lm &lt;- lm(birwt ~ mage, data=birwt.dat)

# Use the predict function to predict values from your model
birwt.dat$p.lm &lt;- predict(mod.lm) 

# now use ggplot!</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex2b-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>mod.lm &lt;- lm(birwt ~ mage, data=birwt.dat)

# Use the predict function to predict values from your model
birwt.dat$p.lm &lt;- predict(mod.lm) 

# now use ggplot!
ggplot(birwt.dat) + 
geom_point(aes(x=mage, y=birwt), color=&#39;grey&#39;) +
geom_line(aes(x=mage, y=p.lm), size=1, color=&quot;purple&quot;) </code></pre>
</div>
</div>
</div>
</div>
<div id="section-review" class="section level2" data-progressive="TRUE">
<h2>Review</h2>
<div id="section-linear-regression-model-output" class="section level3">
<h3>Linear regression model output</h3>
<p>If you got to the end of the first exercise, you should have produced a plot that looks something like this:</p>
<p><img src="multilevel-modelling-i_files/figure-html/unnamed-chunk-1-1.png" width="624" /></p>
</div>
<div id="section-what-about-dependency" class="section level3">
<h3>What about dependency?</h3>
<p>This model ignores the fact that the dataset includes many sets of siblings born to the same mother. These siblings might share genetic or environmental factors that influence their birth weight.</p>
<p>Looking ahead, this is what we we get if we used a multilevel modelling approach to reflect the clustering of children within mothers.</p>
<p><img src="multilevel-modelling-i_files/figure-html/unnamed-chunk-2-1.png" width="624" /></p>
</div>
<div id="section-this-should-be-familiar" class="section level3">
<h3>This should be familiar…</h3>
<p>…to the plot we saw earlier:</p>
<p><img src="images/mlm5.png" style="width:75.0%" /></p>
</div>
</div>
<div id="section-fixed-parameters-or-random-effects" class="section level2">
<h2>Fixed parameters or random effects?</h2>
<p><img src="https://youtu.be/mEcXhYNkJ38" /></p>
<p>Consider the statistical model</p>
<p><span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1}x_{i} + u_{0j} + e_{ij}
\]</span></p>
<p>There are two ways to treat the values <span class="math inline">\(u_{0j}\)</span> in this model: as fixed parameters or as random effects.</p>
<p><strong>1. Fixed parameters</strong><br />
Treating the <span class="math inline">\(u_{0j}\)</span> as <em>fixed parameters</em> means that there is a seperate model parameter for each upper level unit (i.e. hospital in our example). This leads to the <strong>fixed effects</strong> model mentioned previously.</p>
<p>For our toy example with four hospitals, we would have (with some reordering) the model <span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1}u_{01} + \beta_{2}u_{02} + \beta_{3}u_{03} + \beta_{4}x_{i} + e_{ij}
\]</span></p>
<p>Note that there is a parameter for each of the first three hospitals. One parameter is left out as the baseline. Recall the pros and cons of the fixed effects model:</p>
<ul>
<li>Can be suitable if the higher level unit has only a small number of distinct categories (e.g. eight local health districts in NSW)<br />
</li>
<li>This approach is less practical as the number of categories in the higher level unit increases, and becomes more general (e.g. 100s of hospitals in Australia)<br />
</li>
<li>This approach means we can’t include higher level variables in our model</li>
</ul>
<p><strong>2. Random variables</strong><br />
Treating the <span class="math inline">\(u_{0j}\)</span> as <em>random variables</em> means that we assume that they can be modelled as draws from a normal distribution with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma_{u0}^{2}\)</span>:</p>
<p><span class="math display">\[
u_{0j} \sim N(0, \sigma_{u0}^{2})
\]</span> Under this formulation, the values <span class="math inline">\(u_{0j}\)</span> represent unexplained group level effects, also referred to as <em>residuals</em> or <em>random effects</em>. This approach leads to a <strong>multilevel model</strong>.</p>
<p><strong>An important distinction of the multilevel model is that rather than have an additional model parameter for each group residual <span class="math inline">\(u_{0j}\)</span>, only one additional parameter is estimated: the variance <span class="math inline">\(\sigma_{u0}^{2}\)</span></strong></p>
</div>
<div id="section-residuals" class="section level2">
<h2>Residuals</h2>
<p><img src="https://youtu.be/v5QKE7HoGuc" /></p>
<p>In the two-level multilevel model <span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1}x_{i} + u_{0j} + e_{ij}
\]</span> there are two sets of residuals, higher level (level 2) residuals <span class="math inline">\(u_{0j}\)</span> and lower level (level 1) residuals <span class="math inline">\(e_{ij}\)</span>.</p>
<p>The higher level residuals <span class="math inline">\(u_{0j}\)</span>, are the differences between the average regression line and the group regression line for each group <span class="math inline">\(j\)</span>. This is illustrated in the figure below.</p>
<p><img src="images/mlm5.png" style="width:75.0%" /></p>
<p>Note that the values <span class="math inline">\(u_{0j}\)</span> are the difference between the grand mean intercept <span class="math inline">\(\beta_{0}\)</span> and the the intercept for each individual group. The intercept for group 1, for example, is <span class="math inline">\(\beta_{0} + u_{01}\)</span>. Under a multilevel model, we assume that the higher-level residuals are drawn from a normal distribution with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma_{u0}^{2}\)</span>:</p>
<hr />
<p>The individual level residuals <span class="math inline">\(e_{ij}\)</span> are the difference between the data point for unit <span class="math inline">\(i\)</span> and the regression line for group <span class="math inline">\(j\)</span></p>
<p><img src="images/mlm6.png" style="width:75.0%" /></p>
<p>Here, all patients in hospital 1 (the green hospital) share the residual for hospital 1 <span class="math inline">\(u_{01}\)</span> but they each have their own indivual level residual <span class="math inline">\(e_{1,1}\)</span>, <span class="math inline">\(e_{2,1}\)</span> etc. As with single level models, we assume that the lower-level residuals are drawn from a normal distribution with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma_{e}^{2}\)</span>: <span class="math display">\[
e_{ij} \sim N(0, \sigma_{e}^{2})
\]</span></p>
</div>
<div id="section-partitioning-the-variance" class="section level2">
<h2>Partitioning the variance</h2>
<p>Consider a simple multilvel model: a two-level hierarchy with no explanatory variables: <span class="math display">\[
y_{ij} = \beta_{0} + u_{0j} + e_{ij}
\]</span></p>
<p>The residual variance can be decomposed into two parts:</p>
<ul>
<li>The variance of the group residuals <span class="math inline">\(u_{0j}\)</span> around the grand mean <span class="math inline">\(\beta_{0}\)</span></li>
<li>The variance of the individual residuals <span class="math inline">\(e_{ij}\)</span> around the group means.</li>
</ul>
<p>Recall that an assumption of a multilevel model is the values <span class="math inline">\(u_{0j}\)</span> and <span class="math inline">\(e_{ij}\)</span> are both normally distributed with means <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^{2}_{u0}\)</span> and <span class="math inline">\(\sigma^{2}_{e}\)</span> respectively.</p>
<p>Thus the total model variance is <span class="math inline">\(\sigma^{2}_{u0} + \sigma^{2}_{e}\)</span>.</p>
<p>The null or empty model that allows us to decompose the total variance into the residual variance at different levels is sometimes referred to as a <strong>variance components model</strong>.</p>
<div id="section-the-variance-partition-coefficient" class="section level3">
<h3>The Variance Partition Coefficient</h3>
<p>The Variance Partition Coefficient (VPC) is defined as the proportion of the total variance at the higher level: <span class="math display">\[
\frac{\sigma^{2}_{u0}}{\sigma^{2}_{u0} + \sigma^{2}_{e}}
\]</span> The VPC is also the equivalent to the correlation between two randomly selected lower level units in a randomly selected higher level unit (e.g. the correlation between two randomly selected patients in a randomly selected hospital).</p>
</div>
<div id="section-interpreting-the-vpc" class="section level3">
<h3>Interpreting the VPC</h3>
<p>The VPC statistic quantifies how much group dependency is present in the data. Values lie between 0 and 1. High values of the VPC arise when the group level variance is much greater than the individual level variance, i.e. <span class="math display">\[ \sigma^{2}_{u0} &gt;&gt; \sigma^{2}_{e} \]</span></p>
<p>We can visualise this scenario below.</p>
<p><img src="images/mlm7.png" style="width:75.0%" /></p>
<div id="section-high-vpc-closer-to-1-groups-have-a-big-impact-on-response" class="section level4">
<h4>High VPC (closer to 1) Groups have a big impact on response</h4>
<ul>
<li>The group means are spread out away from the grand mean<br />
</li>
<li>The individual observations for each group are close to the group mean<br />
</li>
<li>Most of the variation is between groups; there is little variation within groups</li>
</ul>
<hr />
<p>Low values of the VPC arise when the group level variance is much smaller than the individual level variance, i.e. <span class="math inline">\(\sigma^{2}_{u0} &lt;&lt; \sigma^{2}_{e}\)</span></p>
<p>We can visualise this scenario below:</p>
<p><img src="images/mlm8.png" style="width:75.0%" /></p>
</div>
<div id="section-low-vpc-closer-to-0-groups-have-little-impact-on-the-outcome" class="section level4">
<h4>Low VPC (closer to 0) Groups have little impact on the outcome</h4>
<ul>
<li>The group means are tightly clustered around the grand mean<br />
</li>
<li>The individual observations for each group are widely spread out around the group mean<br />
</li>
<li>Most of the variation is within groups; there is very little variation between groups</li>
</ul>
<hr />
<p>To take the examples above to the extreme, if the individual datapoints all lay on the group mean for each group, then there would be no within-group variation whatsoever and we would have VPC=1. At the other extreme, if all of the groups means lay exactly on the grand mean then we would have no between-group variarion and we would have VPC=0.</p>
<p>In applied settings, a VPC close to 1 is unlikely. A VPC close to zero can arise in settings where the group level has little bearing on the outcome. In such scenarios it would be ok to ignore the hierarchical grouping and undertake a single-level analysis.</p>
<p>The magnitude of the VPC depends on the research context, and we can expect higher or lower values in different settings. Consider a study of children’s health status, based on data from the following scenarios:</p>
<p><strong>Children clustered within communities</strong><br />
Children from the same area might have a somewhat similar health status due to shared environmental exposures and similar socio-economic backgrounds. Nonetheless, we would still expect health to vary widely within communities, and that on average, health status would be pretty similar between communities (at least in an equal society). So we might expect the proportion of the variance at the higher level to be quite small, around <strong>5%</strong><span class="math inline">\(^*\)</span>.</p>
<p><strong>Children clustered within schools</strong> Children attending the same school might be even more similar than children living in the same area because of self-selection into the school system. Nonetheless, we would still expect to see most of the variation in health at the child level. Overall we would expect a higher VPC than the previous example, but still relatively small, about <strong>10%</strong><span class="math inline">\(^*\)</span>.</p>
<p><strong>Children clustered within families</strong> Children from the same family will have a lot of shared exposures that may impact health, including genes, housing and socio-demograpic background. Therefore, we can expect a relatively higher proportion of variation in health to be due to families, perhaps <strong>30%</strong><span class="math inline">\(^*\)</span>.</p>
<p><span class="math inline">\(^*\)</span> <em>These are just rough estimates to give a sense of how the VPC will change in different contexts, don’t take them too seriously.</em></p>
</div>
</div>
</div>
<div id="section-shrinkage" class="section level2">
<h2>Shrinkage</h2>
<p>A special feature of multilevel regression models is <strong>shrinkage</strong>. When estimating the group residuals <span class="math inline">\(u_{0j}\)</span>, the model shrinks these values towards the group mean <span class="math inline">\(\beta_{0}\)</span>. The scale of the shrinkage is inversely proportional to the size of the group <span class="math inline">\(j\)</span>. For large groups, there is little or no shrinkage—the estimated regression line is based on the observed data.</p>
<p>For small groups, however, shrinkage will be larger and the estimated regression line will be pulled toward the average regression line. This facet of multilevel models mean that small groups can “borrow” statistical strength from the population.</p>
<p>The amount of shrinkage is defined by the <strong>shrinkage factor</strong> <span class="math display">\[
\frac{\sigma^{2}_{u}}{\sigma^{2}_{u} + \frac{\sigma^{2}_{e}}{n_{j}}}
\]</span> where <span class="math inline">\(n_{j}\)</span> denotes the number of observations in group <span class="math inline">\(j\)</span>.</p>
<ul>
<li>For larger groups, i.e. as <span class="math inline">\(n_{j}\)</span> increases, the term <span class="math inline">\(\frac{\sigma^{2}_{e}}{n_{j}}\)</span> gets smaller and the shrinkage factor gets closer to 1 (i.e. no shrinkage).<br />
</li>
<li>For small groups the shrinkage factor will tend towards the VPC (imagine if <span class="math inline">\(n_{j}=1\)</span>)<br />
</li>
<li>What is important is the absolute group size, not the proportion of a group observed. e.g. it doesn’t matter if we have 10 patients from a hospital with 20 patients or 2,000 patients, the level of shrinkage is the same.</li>
</ul>
</div>
<div id="section-fitting-mlms-in-r" class="section level2">
<h2>Fitting MLMs in R</h2>
<p><img src="https://youtu.be/Yd0lH6O_X4I" /></p>
<p>There are numerous packages available for fitting multilevel models in R with the package <code>lme4</code> probably the most widely used. As with any choice of R packages, different options come with various pros and cons. All packages will be able to deal with simple models, but for more complex scenarios the choice of package may depend on your application. Some of the available packages and their pros and cons are listed below.</p>
<div id="section-lme4-linear-mixed-effects" class="section level4">
<h4><code>lme4</code> <strong>L</strong>inear <strong>M</strong>ixed <strong>E</strong>ffects</h4>
<ul>
<li>Faster and more memory-efficient than <code>nlme</code></li>
<li>Can fit linear (<code>lmer()</code>), generalized linear (<code>glmer()</code>) and nonlinear (<code>nlmer()</code>) multilevel models.</li>
<li>Not as well-documented as <code>nlme</code></li>
</ul>
</div>
<div id="section-nlme-non-linear-mixed-effects" class="section level4">
<h4><code>nlme</code> <strong>N</strong>on <strong>L</strong>inear <strong>M</strong>ixed <strong>E</strong>ffects</h4>
<ul>
<li>More flexible than <code>lme4</code></li>
<li>Allows for complex variance-covariance structures</li>
<li>Allows for correlation of residuals</li>
</ul>
</div>
<div id="section-brms-bayesian-regression-models-using-stan" class="section level4">
<h4><code>brms</code> <strong>B</strong>ayesian <strong>R</strong>egression <strong>M</strong>odels using <strong>S</strong>tan</h4>
<ul>
<li>Calls the probabilistic programming language <a href="https://mc-stan.org">Stan</a></li>
<li>Bayesian framework offers many advantages (e.g. incorporate prior information and flexible model structure)</li>
<li>Uses <code>lme4</code> syntax</li>
</ul>
<hr />
<p>Today we will be using <code>lme4</code>. Full documentation is available <a href="https://www.rdocumentation.org/packages/lme4/versions/1.1-18-1/topics/lme4-package">here</a>, or by entering <code>help("lme4")</code> at the console.</p>
<p>The basic syntax to fit a <strong>linear multilevel model with a random intercept</strong> using <code>lme4</code> is</p>
<pre class="r"><code>lmer(y~x1 + x2 + (1|level-2-grouping-variable), data=dataset)</code></pre>
<ul>
<li>The fixed part (<span class="math inline">\(y \sim x_{1} + x_{2}\)</span>) of the model is as usual, with the response on the left of a ~ (<em>tilde</em>) operator and the covariates separated by + operators</li>
<li>The random-effects part of the model is enclosed in parentheses: (|)</li>
</ul>
<p>The <code>lme4</code> syntax for specifying a range of multilevel models are summarised <a href="http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#model-specification">here</a>.</p>
</div>
</div>
<div id="section-practical-2" class="section level2">
<h2>Practical 2</h2>
<div id="section-variance-components-model" class="section level3">
<h3>Variance Components model</h3>
<p>In this practical you will fit a variance components (VC) model to the birth weight data. Recall that VC models do not include any covariates in the fixed part. The model has the form: <span class="math display">\[
birwt_{ij} =\beta_{0}  + u_{0j} + e_{ij}
\]</span></p>
<div id="section-work-through-the-code-below-to-fit-a-variance-components-model-with-birth-weight-as-the-outcome" class="section level4">
<h4>Work through the code below to fit a variance components model with birth weight as the outcome</h4>
<div class="tutorial-exercise" data-label="ex4" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># Fit the VC model (i.e. a multilevel model with no predictors and a random intercept for level 2)
mod.vc &lt;- lmer(birwt ~ (1|momid), data=birwt.dat)
summary(mod.vc)

# we can also produce the confidence intervals for the VC model
confint(mod.vc)

# we can get the fixed part of the model
fixef(mod.vc)

# we can get the standard deviation between mothers and within mother
VarCorr(mod.vc)</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
</div>
<div id="section-examining-the-output-above-can-you-answer" class="section level4">
<h4>Examining the output above, can you answer:</h4>
<ul>
<li>What is the average birth weight <span class="math inline">\(\beta_{0}\)</span><br />
</li>
<li>What is the estimated level 1 (child) variance <span class="math inline">\(\sigma^2_{e}}\)</span>?<br />
</li>
<li>What is the estimated level 2 (mother) variance <span class="math inline">\(\sigma^2_{u_0}\)</span>?<br />
</li>
<li>Based on the above, what proportion of the observed variation in birthweight is attributable to mother-level factors?</li>
</ul>
</div>
</div>
</div>
<div id="section-random-intercept-model" class="section level2">
<h2>Random intercept model</h2>
<p>Recall that the variance components model</p>
<p><span class="math display">\[
y_{ij} = \beta_{0} + u_{0j} + e_{ij}
\]</span></p>
<p>The variance components model has a two-level hierarchical structure, without any explanatory variables. We can picture this model as below:</p>
<p><img src="images/mlm7.png" style="width:75.0%" /></p>
<hr />
<p>Earlier we wrote down a similar model for a two-level hierarchy which also included an explanatory variable <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1} x_{ij} + u_{0j} + e_{ij}
\]</span></p>
<p>Below is a simple representation of this model:</p>
<p><img src="images/mlm5.png" style="width:75.0%" /></p>
<hr />
<p>Both of these multilevel models are examples of <strong>random intercept models</strong>. They are so named, because the intercept values for each higher level have a random component. i.e. the values <span class="math inline">\(u_{0j}\)</span>.</p>
<p>Recall that we assume the values <span class="math inline">\(u_{0j}\)</span> are the result of some unmeasured process which can be modelled as draws from a normal distribution <span class="math display">\[
u_{0j} \sim N(0, \sigma_{u0}^2)
\]</span></p>
<p>This means that the model allows the values <span class="math inline">\(u_{0j}\)</span> to vary for different higher level units <span class="math inline">\(j\)</span>: the intercept for Group 1 is <span class="math inline">\(\beta_{0} + u_{01}\)</span>; the intercept for Group 2 is <span class="math inline">\(\beta_{0} + u_{02}\)</span> and so on.</p>
<div id="section-fixed-and-random-parts" class="section level3">
<h3>Fixed and random parts</h3>
<p>Multilevel models can be decomposed into <strong>fixed parts</strong> and <strong>random parts</strong>. For example, in the random intercept model <span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1} x_{ij} + u_{0j} + e_{ij}
\]</span> the fixed part is <span class="math inline">\(\beta_{0} + \beta_{1} x_{ij}\)</span> and the random part is <span class="math inline">\(u_{0j} + e_{ij}\)</span>.</p>
<p>The estimated model will have two parameters relating to the fixed part (<span class="math inline">\(\beta_{0} \text{ and } \beta_{1}\)</span>) and two parameters relating to the random part (<span class="math inline">\(\sigma_{0u}^2\)</span> and <span class="math inline">\(\sigma_{e}^2\)</span>; the variance of the level 1 and level 2 residuals respectively). These different parts of a multilevel model are used to answer different sorts of questions.</p>
<p><strong>Fixed part</strong></p>
<p>The fixed part of the model can be used to answer questions about <strong>variables</strong>. For example, the fixed part parameters could be used to anwser the question <em>is birth weight related to a gestational age?</em>.</p>
<p>If we had data on children <span class="math inline">\(i\)</span> nested within mothers <span class="math inline">\(j\)</span> our model might look like <span class="math display">\[
\text{Weight}_{ij} = \beta_{0} + \beta_{1}\text{Gestation}_{ij} + u_{j} + e_{ij}  
\]</span></p>
<p>In this example, the question about the association between birthweight and gestational age would be given by the fixed part parameter <span class="math inline">\(\beta_{1}\)</span>. In this case, the random part parameter is not really of interest—it is a <em>nuisance</em> parameter. Nonetheless, even though the fixed part of the model provides the answer, we would still use a multilevel model here to account for the clustering of children within mothers—ignoring this would result in incorrect standard errors.</p>
<p>As with a single level model, the fixed part of a multilevel model can be expanded to include additional explanatory variables, including</p>
<ul>
<li>Categorical or continuous variables<br />
</li>
<li>Variable transformations (e.g. <span class="math inline">\(\text{log}(x)\)</span>, <span class="math inline">\(x^2\)</span>)<br />
</li>
<li>Variables at the lower level and variables at the higher level.</li>
<li>Interactions (including interactions between lower and higher level variables, referred to as cross-level interactions)</li>
</ul>
<p>So, to extend our example above, we could fit a random intercept model of the form <span class="math display">\[
\text{Weight}_{ij} = \beta_{0} + \beta_{1}\text{Gestation}_{ij} + \beta_{2}\text{Sex}_{ij} + \beta_{3}\text{Maternal_Age}_{ij} + \beta_{4}\text{Maternal_Education}_{j} + u_{0j} + e_{ij}  
\]</span></p>
<ul>
<li>The variables <em>Weight</em>, <em>Gestation</em>, <em>Maternal Age</em> and <em>Sex</em> refer to the baby (level 1) and receive <span class="math inline">\(ij\)</span> subscripts<br />
</li>
<li>The variable <em>Maternal Education</em> refers to the mother (level 2) and receives a <span class="math inline">\(j\)</span> subscript.</li>
</ul>
<p><strong>Random part</strong></p>
<p>The random part of a multilevel model can be used to ask questions about the <em>levels</em> in the model. For example, the random parameters could be used to answer the question <em>how much of the variation in birth weight is attributable to mothers?</em></p>
<p>Given data on children <span class="math inline">\(i\)</span> nested within mothers <span class="math inline">\(j\)</span>, we could fit a similar model</p>
<p><span class="math display">\[
\text{Weight}_{ij} = \beta_{0} + \beta_{1}\text{Gestation}_{ij} + \beta_{2}\text{Sex}_{ij} + \beta_{3}\text{Maternal_Age}_{ij} + \beta_{4}\text{Maternal_Education}_{j} + u_{0j} + e_{ij} 
\]</span> To answer the research question at hand, our focus is now on the random part of the model: the level 2 variance <span class="math inline">\(u_{0j}\)</span> and the level 1 residual variance <span class="math inline">\(e_{ij}\)</span> (in order to calculate the total variance and hence to proportion of residual variance attributable to mothers).</p>
</div>
</div>
<div id="section-practical-3" class="section level2" data-progressive="TRUE">
<h2>Practical 3</h2>
<div id="section-random-intercepts-model" class="section level3">
<h3>Random Intercepts model</h3>
<p>In this practical you will extend the variance components model to include predictors in the fixed part of the model. i.e. you will fit models of the form <span class="math display">\[
birwt_{ij} =\beta_{0} + \beta_{1}mage_{ij} + u_{0j} + e_{ij}
\]</span> the fixed covariates can be at level-1 or level-2. Here, the exposure of interest—maternal age— is a level-1 variable.</p>
<div id="section-expand-on-the-code-below-to-specify-a-random-intercepts-model-with-maternal-age-as-the-sole-predictor-and-then-answer-the-questions" class="section level4">
<h4>Expand on the code below to specify a random intercepts model with maternal age as the sole predictor, and then answer the questions</h4>
<div class="tutorial-exercise" data-label="ex5" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="20">
<pre class="text"><code># Simple linear regression
mod.lm &lt;- lm(birwt ~ mage, data=birwt.dat)

# Variance components model
mod.vc &lt;- lmer(birwt ~ (1|momid), data=birwt.dat)

# Random intercepts model
#mod.ri &lt;- lmer( )


# Q1. What is the model estimate of the maternal age parameter (with 95% CIs) based on the simple linear regression


# Q2. What is the model estimate of the maternal age parameter (with 95% CIs) based on the random intercepts model?</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="discuss">
<h3 id="section-discuss">Discuss</h3>
<p>Which model had the wider confidence interval for the estimate of the maternal age parameter? Why is this so?</p>
</div>
</div>
</div>
<div id="section-do-we-really-need-a-random-effect" class="section level3">
<h3>Do we really need a random effect?</h3>
<p>We can use a likelihood ratio test to compare model fits, and help decide if we need to account for the clustering of births within mothers when analysising birthweight. By default, the <code>lmer</code> estimates the model using restricted maximum likelihood (REML) because it can provide accurate estimates, especially when the number of clusters is small. However, when we do a likelihood ratio test, we need to fit the models with maximum likelihood. Luckily, R will automatically refit these models using maximum likelihoods before performing the test. Alternatively, we could update the model by using the update function with REML attribute equal to FALSE before comparing the two models e.g. update(model2, REML=FALSE).</p>
<p>The exercise block below is primed with the models you have estimated above. Use the <code>anova</code> command to compare model fit between the simple linear regression and the random intercepts model. Note that the basic syntax for ANOVA is as below, where model 1 is the simpler model, nested within model 2.</p>
<pre class="r"><code>anova(model2, model1)</code></pre>
<div class="tutorial-exercise" data-label="ex7" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="12">
<pre class="text"><code># Simple linear regression
mod.lm &lt;- lm(birwt ~ mage, data=birwt.dat)

# Random intercepts model
mod.ri &lt;- lmer(birwt ~ mage + (1|momid), data=birwt.dat)

# Compare models
anova(mod.ri, mod.lm)</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="discuss">
<h3 id="section-discuss-1">Discuss</h3>
<p>Based on the above, which model provides a better fit? Is this answer intuitive?</p>
</div>
</div>
</div>
<div id="section-random-slope-models" class="section level2">
<h2>Random slope models</h2>
<p>Consider the following multilevel data, where individuals are represented by points, and groups are distinguished by colour.</p>
<p><img src="images/mlm9.png" style="width:75.0%" /></p>
<p>(Of course multilevel level applications always have more than four higher level units, but we will focus on four for ease of illustration)</p>
<hr />
<p>Fitting a random intercept model to these data results in a seperate line for each group.</p>
<p><img src="images/mlm10.png" style="width:75.0%" /></p>
<p>An assumption inherent to the random intercept model is that the fitted group lines must be parallel. An equivalent way of saying this is that the association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is the same in each group.</p>
<p>But is this assumption adequate?</p>
<hr />
<p>Not always. In some cases, the effect of an explanatory variable can be different across higher level groups. In the example above, the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is stronger in the green group and weaker in the yellow group.</p>
<p>A <strong>random slopes model</strong> allows us to relax the assumption that the association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is the same in each higher level grouping variable. This means that we can fit a model with different slopes for each group line, resulting in a better fit to the data:</p>
<p><img src="images/mlm11.png" style="width:75.0%" /></p>
<hr />
<p>Recall that the basic equation for the random intercept model was</p>
<p><span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1} x_{ij} + u_{0j} + e_{ij} 
\]</span></p>
<p>where <span class="math display">\[
u_{0j} \sim N(0, \sigma_{u0}^2) 
\]</span></p>
<p>and <span class="math display">\[
e_{ij} \sim N(0, \sigma_{e}^2)
\]</span></p>
<p>In this model the slope parameter <span class="math inline">\(\beta_{1}\)</span> is the same for all groups.</p>
<p>In a <strong>random intercept</strong> model, the slope parameter can vary across groups. Notationally, we replace <span class="math inline">\(\beta_{1}\)</span> with <span class="math inline">\(\beta_{1j}\)</span> to indicate this. We can rewrite <span class="math inline">\(\beta_{1j}\)</span> as</p>
<p><span class="math display">\[
\beta_{1j} = \beta_{1} + u_{1j}
\]</span> where <span class="math inline">\(\beta_{1}\)</span> indicates the average slope across all groups and <span class="math inline">\(u_{1j}\)</span> indicates departures from the average slope for individual groups. The values <span class="math inline">\(u_{1j}\)</span> are referred to as random slopes. They represent unmeasured factors which vary the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in different groups. As with the random intercept values <span class="math inline">\(u_0j\)</span> we assume that the random slope values <span class="math inline">\(u_{1j}\)</span> follow a normal distribution with mean 0 and variance <span class="math inline">\(\sigma_{u1}^2\)</span>: <span class="math display">\[
u_{1j} \sim N(0, \sigma_{u1}^2)
\]</span></p>
<p>The random slope for Group 1 <span class="math inline">\(u_{11}\)</span> is depicted below.</p>
<p><img src="images/mlm12.png" style="width:75.0%" /></p>
<ul>
<li><span class="math inline">\(\beta_{0}\)</span> is the intercept of the average lines for all groups<br />
</li>
<li><span class="math inline">\(\beta_{1}\)</span> is the slope of the average line for all groups<br />
</li>
<li><span class="math inline">\(u_{11}\)</span> is the difference between the average slope <span class="math inline">\(\beta_{1}\)</span> and the slope for Group 1<br />
</li>
<li>The dotted lines in the diagram aren’t fitted lines, they are just there to help illustrate the different slopes</li>
</ul>
<hr />
<p>Adding the term <span class="math inline">\(\beta_{1j} = \beta_{1} + u_{1j}\)</span> to our random intercepts model equation, and rearranging slighlty, we get the following random slopes model equation <span class="math display">\[
y_{ij} = \beta_{0} + \beta_{1} x_{ij} + u_{0j} + u_{1j} + e_{ij}
\]</span> As before, the <strong>fixed part</strong> of the model is <span class="math display">\[
\beta_{0} + \beta_{1} x_{ij}
\]</span> The random part of the model now has an additional term<br />
<span class="math display">\[
u_{0j} + u_{1j} + e_{ij}
\]</span> Earlier we said that the random intercepts <span class="math inline">\(u_{0j}\)</span> and the random slopes <span class="math inline">\(u_{1j}\)</span> both follow normal distributions with means 0 and variances <span class="math inline">\(\sigma_{u0}^2\)</span> and <span class="math inline">\(\sigma_{u1}^2\)</span> respectively.</p>
<p>But this is not the full story.</p>
<p>The random slopes model also allows for a correlation between the values <span class="math inline">\(u_{0j}\)</span> and the random slopes <span class="math inline">\(u_{1j}\)</span>. This correlation is denoted <span class="math inline">\(\sigma_{u01}\)</span>. Thus, rather than assume the values <span class="math inline">\(u_{0j}\)</span> and <span class="math inline">\(u_{1j}\)</span> are drawn from independent normal distributions, the random slopes model assumes that they are drawn from a multivariate normal distribution: <span class="math display">\[
\binom{u_{0j}}{u_{1j}} \sim \text{MVN} \left(\begin{matrix} \sigma_{u0}^2 &amp; \sigma_{u01}\\ \sigma_{u01} &amp; \sigma_{u1}^2 \end{matrix} \right) 
\]</span></p>
<ul>
<li><span class="math inline">\(\sigma_{u0}^2\)</span> is the variance of the random intercepts<br />
</li>
<li><span class="math inline">\(\sigma_{u1}^2\)</span> is the variance of the random slopes</li>
<li><span class="math inline">\(\sigma_{u01}\)</span> is the covariance between the intercepts and slopes</li>
</ul>
<p>The parameter <span class="math inline">\(\sigma_{u01}\)</span> is the <em>covariance</em></p>
<div id="section-how-do-we-interpret-correlated-random-intercepts-and-random-slopes" class="section level3">
<h3>How do we interpret correlated random intercepts and random slopes?</h3>
<p><img src="https://youtu.be/BIroLtHSKGk" /></p>
<p><strong>Positive covariance</strong></p>
<p>Positive values of <span class="math inline">\(\sigma_{u01}\)</span> indicate that positive random intercepts tend to have positive random slopes and negative random intercepts tend to have negative random slopes. This corresponds to a <strong>fanning-out</strong> pattern for the fitted group lines:</p>
<p><img src="images/mlm13.png" style="width:75.0%" /></p>
<p><strong>Negative covariance</strong></p>
<p>Negative values of <span class="math inline">\(\sigma_{u01}\)</span> indicate that positive random intercepts tend to have negative random slopes, and negative random intercepts tend to have positive random slopes. This corresponds to a <strong>fanning-in</strong> pattern for the fitted group lines:</p>
<p><img src="images/mlm14.png" style="width:75.0%" /></p>
<p><strong>Null covariance</strong> <span class="math inline">\(\sigma_{u01}\)</span> close to zero indicate no consistent relationship between the slopes and the intercepts:</p>
<p><img src="images/mlm15.png" style="width:75.0%" /></p>
</div>
</div>
<div id="section-activity" class="section level2">
<h2>Activity</h2>
<div class="shiny">
<h3 id="section-activity-1">Activity</h3>
<p>Use the <a href="https://cbdrh.shinyapps.io/mlm1/">interactive Shiny app</a> to connect ideas between multilevel data, multilevel models, and fitting and interpreting models in R. The app can also be launched by entering <code>hdat9700tutorials::run('mlm1')</code> at the console.</p>
<p>The app allows you to generate multilevel data under different data generation mechanisms. You can then fit a multilevel model to the data, visualise the output and review the corresponding R syntax and model output.</p>
</div>
</div>
<div id="section-practical-4" class="section level2" data-progressive="TRUE">
<h2>Practical 4</h2>
<div id="section-random-slope-models-1" class="section level3">
<h3>Random Slope models</h3>
<p>The random intercept model you fitted previously constrained the effect of maternal age on birthweight to be the same for all mothers. Now we will relax this constraint, and fit a model which allows the effect of maternal age to vary across mothers. i.e. we will fit models of the form <span class="math display">\[
birwt_{ij} =\beta_{0} + \beta_{1}mage_{ij} + u_{0j} + e_{ij} + u_{1ij}mage_{ij}
\]</span> Extend the code for the random intercepts model to specify a random slopes model:</p>
<div class="tutorial-exercise" data-label="ex8" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="12">
<pre class="text"><code># Random Intercepts model
mod.ri &lt;- lmer(birwt ~ mage + (1|momid), data=birwt.dat)

# Random slopes model</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="ex8-hint-1" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># The variable &#39;mage&#39; should appear in the fixed part and the random part of the model</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex8-hint-2" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># Random slopes model

# Having convergence problems?
# Try using the centred versions of the variables! birwtc and magec</code></pre>
</div>
<div class="tutorial-exercise-support" data-label="ex8-hint-3" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code># Random slopes model
mod.rs &lt;- lmer(birwtc ~ magec + (1 + magec|momid), data=birwt.dat)</code></pre>
</div>
<div class="discuss">
<h3 id="section-discuss-2">Discuss</h3>
<p>How do you interpret the sign of the level two covariance estimate? Can you draw a rough picture to help understand this?</p>
<p><strong>Hints</strong></p>
<ul>
<li>Birthweight on the y-axis;</li>
<li>Maternal age on the x-axis</li>
<li>Draw three lines for three hypothetical mothers: one with an average <span class="math inline">\(\beta_{0}\)</span>, one with an above average <span class="math inline">\(\beta_{0}\)</span>, and one with a below average <span class="math inline">\(\beta_{0}\)</span></li>
</ul>
</div>
</div>
</div>
<div id="section-summary" class="section level2">
<h2>Summary</h2>
<div id="section-overview-1" class="section level3">
<h3>Overview</h3>
<p>This chapter has introduced multilevel models. We have covered the motivation and notation for multilevel models and fitted three types of models using the <code>lmer</code> package in R:</p>
<ul>
<li>Variance components models</li>
<li>Random intercept models<br />
</li>
<li>Random slope models</li>
</ul>
</div>
<div id="section-next-week" class="section level3">
<h3>Next week</h3>
<p>Next week we will continue to focus on multilevel models. We will cover</p>
<ul>
<li>Multilevel models for binary outcomes<br />
</li>
<li>Diagnostics</li>
<li>Predictions 
<script type="application/shiny-prerendered" data-context="server-start">
knitr::opts_chunk$set(echo = FALSE)

library(learnr)
library(tidyverse)
library(epiDisplay)
library(dplyr)    
library(ggplot2)  
library(lme4)     
library(lattice)
library(nlme)
library(sjPlot)
library(sjmisc)
library(HLMdiag)


birwt.dat <- read.csv("data/smoking_data.csv", header=T) %>% 
  mutate(birwtc = (birwt-mean(birwt))/sd(birwt), magec = (mage-mean(mage))/sd(mage))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = list(id = "au.edu.unsw.cbdrh.hdat9700.tutorials.multilevel-modelling-i"))
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex1-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex1-code-editor`)), session)
output$`tutorial-exercise-ex1-output` <- renderUI({
  `tutorial-exercise-ex1-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex2-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex2-code-editor`)), session)
output$`tutorial-exercise-ex2-output` <- renderUI({
  `tutorial-exercise-ex2-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex2b-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex2b-code-editor`)), session)
output$`tutorial-exercise-ex2b-output` <- renderUI({
  `tutorial-exercise-ex2b-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex4-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex4-code-editor`)), session)
output$`tutorial-exercise-ex4-output` <- renderUI({
  `tutorial-exercise-ex4-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex5-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex5-code-editor`)), session)
output$`tutorial-exercise-ex5-output` <- renderUI({
  `tutorial-exercise-ex5-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex7-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex7-code-editor`)), session)
output$`tutorial-exercise-ex7-output` <- renderUI({
  `tutorial-exercise-ex7-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-ex8-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-ex8-code-editor`)), session)
output$`tutorial-exercise-ex8-output` <- renderUI({
  `tutorial-exercise-ex8-result`()
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.3"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","bayestestR","blob","boot","broom","cellranger","cli","coda","codetools","colorspace","compiler","crayon","datasets","DBI","dbplyr","digest","dplyr","effectsize","ellipsis","emmeans","epiDisplay","estimability","evaluate","fansi","farver","fastmap","forcats","foreign","fs","generics","ggeffects","ggplot2","glue","graphics","grDevices","grid","gtable","haven","HLMdiag","hms","htmltools","htmlwidgets","httpuv","httr","insight","jsonlite","knitr","labeling","later","lattice","learnr","lifecycle","lme4","lubridate","magrittr","markdown","MASS","Matrix","methods","mgcv","mime","minqa","modelr","multcomp","munsell","mvtnorm","nlme","nloptr","nnet","parameters","performance","pillar","pkgconfig","plyr","promises","purrr","R6","Rcpp","readr","readxl","reprex","reshape2","rlang","RLRsim","rmarkdown","rprojroot","rstudioapi","rvest","sandwich","scales","shiny","sjlabelled","sjmisc","sjPlot","sjstats","splines","statmod","stats","stringi","stringr","survival","TH.data","tibble","tidyr","tidyselect","tidyverse","tools","utils","vctrs","withr","xfun","xml2","xtable","yaml","zoo"]},{"type":"character","attributes":{},"value":["0.2.1","1.1.9","3.6.1","0.7.2","1.2.1","1.3-23","0.7.0","1.1.0","2.0.2","0.19-3","0.2-16","1.4-1","3.6.1","1.3.4","3.6.1","1.1.0","1.4.4","0.6.25","1.0.2","0.3.2","0.3.1","1.5.0","3.5.0.1","1.3","0.14","0.4.1","2.0.3","1.0.1","0.5.0","0.8-72","1.5.0","0.0.2","0.15.1","3.3.2","1.4.2","3.6.1","3.6.1","3.6.1","0.3.0","2.3.1","0.3.1","0.5.3","0.5.0","1.5.1","1.5.4","1.4.2","0.9.5","1.7.1","1.29","0.3","1.1.0.1","0.20-38","0.10.1","0.2.0","1.1-23","1.7.9","1.5","1.1","7.3-51.4","1.2-17","3.6.1","1.8-28","0.9","1.2.4","0.1.8","1.4-10","0.5.0","1.1-1","3.1-143","1.2.2.2","7.3-12","0.8.2","0.4.8","1.4.6","2.0.3","1.8.6","1.1.1","0.3.4","2.4.1","1.0.5","1.3.1","1.3.1","0.3.0","1.4.4","0.4.7","3.1-6","2.3","1.3-2","0.11","0.3.6","2.5-1","1.1.1","1.5.0","1.1.6","2.8.5","2.8.4","0.18.0","3.6.1","1.4.34","3.6.1","1.5.3","1.4.0","2.44-1.1","1.0-10","3.0.3","1.1.2","1.1.0","1.3.0","3.6.1","3.6.1","0.3.4","2.2.0","0.17","1.3.2","1.8-4","2.2.1","1.8-8"]}]}]}
</script>
<!--/html_preserve--></li>
</ul>
</div>
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">HDAT9700: Multilevel Modelling (Part I)</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
